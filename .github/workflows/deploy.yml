name: "Deploy"

on:
  workflow_call:
    inputs:
      environment:
        required: true
        type: string

jobs:
  deploy_to_play_store:
    name: "Deploy To The Play Store"
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    steps:
      - name: "ğŸ› Checkout"
        uses: actions/checkout@v4
      - name: "ğŸ”§ Setup"
        uses: ./.github/actions/use-dependencies
      - name: "ğŸ”‘ Create Android signing keys"
        env:
          ANDROID_KEY_ALIAS: ${{ secrets.ANDROID_KEY_ALIAS }}
          ANDROID_KEY_PASSWORD: ${{ secrets.ANDROID_KEY_PASSWORD }}
          ANDROID_KEYSTORE: ${{ secrets.ANDROID_KEYSTORE }}
          ANDROID_KEYSTORE_PASSWORD: ${{ secrets.ANDROID_KEYSTORE_PASSWORD }}
        run: ./scripts/create_android_signing_keys.sh
      - name: "ğŸ—ï¸ Build AppBundle"
        run: flutter build appbundle --release
